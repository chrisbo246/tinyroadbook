{"version":3,"sources":["mapInputsModule.js"],"names":[],"mappings":"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","file":"mapInputsModule.js","sourcesContent":["/*eslint-env browser, jquery */\n/*global escape, ol */\n/**\n * OL3 inputs module.\n * @module\n * @external $\n * @external escape\n * @external ol\n * @return {Object} Public functions / variables\n */\n/*eslint-disable no-unused-vars*/\nvar mapInputsModule = (function () {\n    /*eslint-enable no-unused-vars*/\n    'use strict';\n\n    /** @private */\n    var map;\n\n\n\n    /** @private */\n    var inputs = {};\n\n\n\n    /**\n     * Create a new input using predefined settings\n     * @public\n     * @param {string} name - Predefined input (variable name)\n     * @return {Object} OL3 layer\n     */\n    var create = function (name, selector) {\n        if (!inputs[name]) {\n            console.warn(name + ' input definition does not exists');\n            return false;\n        }\n        var input = inputs[name](selector);\n        return input;\n    };\n\n\n\n    /**\n     * Base layer select\n     * @param {string} selector - Select input ID\n     * @param {Object} map - OL3 map\n     */\n    inputs.layer = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            map.getLayers().forEach(function (layer) {\n                if (layer.get('visible')) {\n                    $input.val(layer.get('name'));\n                }\n            });\n            $input.on('change', function () {\n                var name = $input.find(':selected').val();\n                map.getLayers().forEach(function (layer) {\n                    layer.set('visible', (layer.get('name') === name));\n                });\n            });\n        }\n    };\n\n\n\n    /**\n     * Map zoom input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.zoom = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            $input.val(this.getZoom());\n            $input.on('change', function () {\n                var val = $input.val();\n                if (val || val === 0) {\n                    map.getView().setZoom(val);\n                }\n            });\n            map.getView().on('change:resolution', function () {\n                $input.val(this.getZoom());\n            });\n        }\n    };\n\n\n\n    /**\n     * Map resolution input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.resolution = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            $input.val(this.getResolution());\n            $input.on('change', function () {\n                var val = $input.val();\n                if (val || val === 0) {\n                    map.getView().setResolution(val);\n                }\n            });\n            map.getView().on('change:resolution', function () {\n                $input.val(this.getResolution());\n            });\n        }\n    };\n\n\n\n    /**\n     * Map rotation input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.rotation = function (selector) {\n        var $input = $(selector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                map.getView().setRotation(val);\n            }\n        });\n        map.getView().on('change:rotation', function () {\n            $input.val(this.getRotation());\n        });\n    };\n\n\n\n    /**\n     * Map X center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.centerX = function (selector) {\n        var $input = $(selector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                // map.getView().setCenter($centerX.val(), $centerY.val());\n            }\n        });\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            $input.val(lonLat[0]); // .toFixed(2)\n        });\n    };\n\n\n\n    /**\n     * Map Y center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.centerY = function (selector) {\n        var $input = $(selector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                //map.getView().setCenter($centerX.val(), val);\n            }\n        });\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            $input.val(lonLat[1]); // .toFixed(2)\n        });\n    };\n\n\n\n    /**\n     * Map XY center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.center = function (Xselector, Yselector) {\n        var $centerX = $(Xselector);\n        var $centerY = $(Yselector);\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            if (lonLat) {\n                $centerX.val(lonLat[0].toFixed(2));\n                $centerY.val(lonLat[1].toFixed(2));\n            }\n        });\n        $(Xselector + ', ' + Yselector).on('change', function () {\n            if (($centerX.val() || $centerX.val() === 0) && ($centerY.val() || $centerY.val() === 0)) {\n                map.getView().setCenter($centerX.val(), $centerY.val());\n            }\n        });\n    };\n\n\n\n    /**\n     * Export map as PNG\n     */\n    inputs.exportPNG = function () {\n        var $input = document.getElementById('export-png');\n        if ($input) {\n            $input.on('click', function () {\n                map.once('postcompose', function (event) {\n                    var canvas = event.context.canvas;\n                    $input.attr('href', canvas.toDataURL('image/png'));\n                });\n                // map.renderSync();\n            });\n        }\n    };\n\n\n\n    /**\n     * Update layer source url from a file input\n     * <input id=\"gpx_file\" type=\"file\" accept=\".gpx\" />\n     * @see {@link http://www.html5rocks.com/en/tutorials/file/dndfiles/}\n     * @public\n     * @param {string} selector - File input ID\n     * @param {Object} layer - OL3 vector layer\n     */\n    inputs.GPXSource = function (selector, layer) {\n        if (!(window.File && window.FileReader && window.FileList && window.Blob)) {\n            console.warn('The File APIs are not fully supported in this browser.');\n        }\n        var $filePath = $(selector);\n        $filePath.on('change', function (inputEvent) {\n            var files = inputEvent.target.files;\n            files.forEach(function (f) {\n                var reader = new FileReader();\n                reader.onload = (function (loadEvent) {\n                    return function (returned) {\n                        layer.setProperties({\n                            title: escape(loadEvent.name),\n                            source: new ol.source.Vector({\n                                url: returned.target.result,\n                                format: new ol.format.GPX()\n                            }),\n                            visible: true\n                        });\n                    };\n                })(f);\n                reader.readAsDataURL(f);\n            });\n        });\n    };\n\n\n    return {\n        create: create\n    };\n\n})();\n"],"sourceRoot":"/source/"}