{"version":3,"sources":["../../app/scripts/mapInputsModule.js"],"names":[],"mappings":"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","file":"mapInputsModule.js","sourcesContent":["//jslint browser: true\n//global $, mapModule\n\n/**\n * OL3 inputs module.\n * @external jQuery\n * @external OL3\n * @external mapModule\n * @module\n * @returns {Object} mapModule\n */\nvar mapInputsModule = (function () {\n    'use strict';\n\n    /** @private */\n    var map;\n\n    /** @private */\n    var inputs = {};\n\n\n\n    /**\n     * Create a new input using predefined settings\n     * @public\n     * @param {string} name - Predefined input (variable name)\n     * @returns {Object} OL3 layer\n     */\n    var create = function (name, selector, map) {\n\n        if (!inputs[name]) {\n            console.warn(name + ' input definition does not exists');\n            return;\n        }\n\n        var input = inputs[name](selector);\n\n        return input;\n\n    };\n\n\n\n    /**\n     * Base layer select\n     * @param {string} selector - Select input ID\n     * @param {Object} map - OL3 map\n     */\n    inputs.layer = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            map.getLayers().forEach(function (layer) {\n                if (layer.get('visible')) {\n                    $input.val(layer.get('name'));\n                }\n            });\n            $input.on('change', function () {\n                var name = $input.find(':selected').val();\n                map.getLayers().forEach(function (layer) {\n                    layer.set('visible', (layer.get('name') === name));\n                });\n            });\n        }\n    };\n\n\n\n    /**\n     * Map zoom input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.zoom = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            $input.val(this.getZoom());\n            $input.on('change', function () {\n                var val = $input.val();\n                if (val || val === 0) {\n                    map.getView().setZoom(val);\n                }\n            });\n            map.getView().on('change:resolution', function () {\n                $input.val(this.getZoom());\n            });\n        }\n    };\n\n\n\n    /**\n     * Map resolution input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.resolution = function (selector) {\n        var $input = $(selector);\n        if ($input) {\n            $input.val(this.getResolution());\n            $input.on('change', function () {\n                var val = $input.val();\n                if (val || val === 0) {\n                    map.getView().setResolution(val);\n                }\n            });\n            map.getView().on('change:resolution', function () {\n                $input.val(this.getResolution());\n            });\n        }\n    };\n\n\n\n    /**\n     * Map rotation input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.rotation = function (selector) {\n        var $input = $(selector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                map.getView().setRotation(val);\n            }\n        });\n        map.getView().on('change:rotation', function () {\n            $input.val(this.getRotation());\n        });\n    };\n\n\n\n    /**\n     * Map X center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.centerX = function (selector) {\n        var $input = $(Xselector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                // map.getView().setCenter($centerX.val(), $centerY.val());\n            }\n        });\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            $input.val(lonLat[0]); // .toFixed(2)\n        });\n    };\n\n\n\n    /**\n     * Map Y center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.centerY = function (selector) {\n        var $input = $(selector);\n        $input.on('change', function () {\n            var val = $input.val();\n            if (val || val === 0) {\n                //map.getView().setCenter($centerX.val(), val);\n            }\n        });\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            $input.val(lonLat[1]); // .toFixed(2)\n        });\n    };\n\n\n\n    /**\n     * Map XY center input\n     * @param {string} selector - Input ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.center = function (Xselector, Yselector) {\n        var $centerX = $(Xselector);\n        var $centerY = $(Yselector);\n        map.getView().on('change:center', function () {\n            var lonLat = this.getCenter();\n            if (lonLat) {\n                $centerX.val(lonLat[0].toFixed(2));\n                $centerY.val(lonLat[1].toFixed(2));\n            }\n        });\n        $(Xselector + ', ' + Yselector).on('change', function () {\n            if (($centerX.val() || $centerX.val() === 0) && ($centerY.val() || $centerY.val() === 0)) {\n                map.getView().setCenter($centerX.val(), $centerY.val());\n            }\n        });\n    };\n\n\n\n    /**\n     * Export map as PNG\n     * @param {string} selector - Link ID or class\n     * @param {Object} map - OL3 map\n     */\n    inputs.exportPNG = function (selector) {\n        var $input = document.getElementById('export-png');\n        if ($input) {\n            $input.on('click', function () {\n                map.once('postcompose', function (event) {\n                    var canvas = event.context.canvas;\n                    $input.attr('href', canvas.toDataURL('image/png'));\n                });\n                // map.renderSync();\n            });\n        }\n    };\n\n\n\n    /**\n     * Update layer source url from a file input\n     * <input id=\"gpx_file_path\" type=\"file\" accept=\".gpx\" />\n     * @see {@link http://www.html5rocks.com/en/tutorials/file/dndfiles/}\n     * @public\n     * @param {string} selector - File input ID\n     * @param {Object} layer - OL3 vector layer\n     */\n    inputs.GPXSource = function (selector, layer) {\n\n        if (!(window.File && window.FileReader && window.FileList && window.Blob)) {\n            console.warn('The File APIs are not fully supported in this browser.');\n        }\n\n        var $filePath = $(selector);\n        $filePath.on('change', function (e) {\n\n            var files = e.target.files;\n            files.forEach(function (f) {\n\n                var reader = new FileReader();\n                reader.onload = (function (theFile) {\n                    return function (e) {\n                        layer.setProperties({\n                            title: escape(theFile.name),\n                            source: new ol.source.Vector({\n                                url: e.target.result,\n                                format: new ol.format.GPX()\n                            }),\n                            visible: true\n                        });\n                    };\n                })(f);\n\n                reader.readAsDataURL(f);\n\n            });\n\n        });\n\n    };\n\n    \n    \n    return {\n        create: create\n    };\n\n})();"]}