{"version":3,"sources":["../../app/scripts/cityPickerModule.js"],"names":[],"mappings":"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","file":"cityPickerModule.js","sourcesContent":["//jslint browser: true\n//global window, console, $, ol, swal, Quill, geocodeModule\n\n/**\n * City picker module.\n * @external jQuery\n * @external OL3\n * @external swal\n * @external Quill\n * @external geocodeModule\n * @module\n * @returns {Object} Public functions and variables\n */\nvar cityPickerModule = (function () {\n    'use strict';\n\n    var editor;\n\n    var settings = {\n        quill: {\n            //readOnly: false,\n            //theme: 'snow',\n            styles: false,\n            formats: ['bold', 'italic', 'strike', 'underline',\n                    'font', 'size', 'align', 'color', 'background'] //'bullet', 'list', 'image', 'link'\n        }\n    };\n\n    \n\n    /**\n     * Convert a number to a name according to the range of values\n     * @param {number} number - The number to convert\n     * @param {number} min - The minimal value the number can have\n     * @param {number} min - The minimal value the number can have\n     * @param {array} values - Possible returned values sorted from the smallest to the biggest\n     * @param {integer} index - Default value (array index starting from 0)\n     * @returns {string} One of the possible values\n     */\n    var numberToName = function (number, min, max, values, index) {\n        //if (!$.isNumeric(number)) return values[index];\n\n        // Define the default value with the medium value if empty\n        index = index || Math.ceil(values.length / 2);\n        // Make sure the number is in the min-max range\n        number = Math.min(Math.max(number, min), max);\n\n        var step = (max - min) / values.length;\n        var i = (number - min) / step;\n        i = i.toFixed(0);\n        var name = values[i] || values[index];\n        console.log('numberToFontSize(' + number + ', ' + min + ', ' + max + ') step:' + step + ' i:' + i + ' name:' + name);\n        return name;\n    };\n\n\n\n    /**\n     * Convert a number to a valid font size-name\n     * @param {number} number - Value to convert\n     * @param {number} min - The smallest value accepted\n     * @param {number} max - The biggest value accepted\n     * @returns {string} A valid font size-name from xx-small to xx-large\n     */\n    var _numberToFontSizeName = function (number, min, max) {\n        var array = ['xx-small', 'x-small', 'smaller', 'small', 'normal',\n                'large', 'larger', 'x-large', 'xx-large'];\n        return numberToName(number, min, max, array, 4);\n    };\n\n\n    /**\n     * Convert a number to a valid color name\n     * @param {number} number - Value to convert\n     * @param {number} min - The smallest value accepted\n     * @param {number} max - The biggest value accepted\n     * @returns {string} A valid color name\n     */\n    var _numberToColorName = function (number, min, max) {\n        var array = ['lightgray', 'gray', 'black']; // 'whitesmock', 'silver',\n        return numberToName(number, min, max, array, 1);\n    };\n\n\n\n    /**\n     * Prepare cursor for insertion\n     * - Delete selected text\n     * - Move to the end if position cannot be found\n     * - Set position to 0 if editor is empty (pos 1)\n     * @returns {integer} Cursor position\n     */\n    var _posBeforeInsert = function () {\n\n        var pos;\n        var length = editor.getLength();\n        // Focus editor prior to get selection\n        if (length > 1) {\n            editor.focus();\n        }\n        var range = editor.getSelection();\n\n        if (range) {\n            pos = range.start; //+ 1\n            if (range.start !== range.end) {\n                editor.deleteText(range.start, range.end);\n            }\n            console.log('Cursor ready for insertion at pos ' + pos);\n        } else {\n            pos = length - 1;\n            console.log('Cursor is ready for insertion at the last pos ' + pos);\n        }\n        //if (pos === 1) pos = 0;\n\n        return pos;\n\n    };\n\n\n\n    /**\n     * Add city name to the editor\n     * @param {Object} json - The JSON object returned by Nominatim\n     */\n    var _insertCity = function (json) {\n\n        var size,\n            color,\n            names = [],\n            types = ['country', 'state', 'county',\n                    'city', 'town', 'village', 'hamlet']; //'state_district', 'city_district',\n        //var smallestAreaType = $('#smallest_area_type').val() || 'village';\n\n        if (!json) {\n            return;\n        }\n\n        if (json.address) {\n            var name;\n            types.forEach(function (value) {\n                if (json.address[value]) {\n                    name = json.address[value];\n                    //console.log(value + '/' + smallestAreaType);\n                    //if (value === smallestAreaType) {\n                    //    return false;\n                    //}\n                }\n            });\n            names.push(name);\n        }\n\n        if (json.extratags) {\n            // Define font size depending on population\n            if (json.extratags.population && $('#font_size_proportional').is(':checked')) {\n                //var size = (Math.log(json.extratags.population) / 15 + 0.4).toFixed(2) + 'em';\n                size = _numberToFontSizeName(Math.log(json.extratags.population) || 0, 0, Math.log(25000000));\n            }\n            if (json.extratags.population && $('#font_color_proportional').is(':checked')) {\n                //var val = (255 - Math.log(json.extratags.population) * 15).toFixed(0);\n                //var color = 'rgb(' + val + ', ' + val + ', ' + val + ')';\n                color = _numberToColorName(Math.log(json.extratags.population) || 0, 0, Math.log(25000000));\n            }\n        }\n\n        if (json.namedetails) {\n            // Add also the local language name\n            if ($('#insert_local_name').is(':checked') && json.namedetails.name) {\n                names.push(json.namedetails.name);\n            }\n        }\n\n        // Insert text\n        if (names.length > 0) {\n            var pos = _posBeforeInsert();\n            var text;\n\n            // Insert icon\n            if (json.icon && $('#insert_icon') && $('#insert_icon').is(':checked')) {\n                text = json.icon;\n                console.log('pos:' + pos + ' text:' + text);\n                editor.insertEmbed(pos, 'image', text);\n                pos = pos + 1;//text.length;\n                //console.log('Cursor positioned at pos:' + pos + '/' + editor.getLength() - 1);\n            }\n\n            // Insert city name\n            text = $.unique(names).join(' / ');\n            editor.insertText(pos, text, {\n                'size': size || '1em',\n                'color': color || 'black'\n            });\n            pos = pos + text.length;\n            //console.log('Cursor positioned at pos:' + pos + '/' + editor.getLength() - 1);\n\n            // Insert a separator\n            var $separator = $('#separator');\n            text = ($separator) ? $separator.val() : '\\n';\n            editor.insertText(pos, text);\n            pos = pos + text.length;\n            //console.log('Cursor positioned at pos:' + pos + '/' + editor.getLength() - 1);\n\n            // Move cursor after insertions\n            editor.setSelection(pos, pos);\n\n            console.log('Cursor positioned at pos:' + pos + '/' + editor.getLength() - 1);\n\n\n        } else {\n            console.log('Extracted data does not contain a city name.');\n        }\n\n\n\n    };\n\n\n\n    /**\n     * Use reverse geocode to define the name of the city at a given position\n     * @param {object} json - The JSON object returned by Nominatim reverse geocode\n     */\n    var _getCityDetails = function (json) {\n\n        if (!json || !json.address) {\n            return;\n        }\n\n        var params = {\n            format: 'json',\n            limit: 1,\n            polygon_svg: 0,\n            addressdetails: 1,\n            extratags: 1,\n            namedetails: 1\n            //'accept-language': 'en'\n        };\n\n        // Build query\n        var query = [];\n        // , 'city_district', 'state_district'\n        ['village', 'town', 'city', 'county', 'state', 'country'].forEach(function (value) {\n            if (json.address[value]) {\n                query.push(json.address[value]);\n                //console.log(json.address[value]);\n                return false;\n            }\n        });\n\n        // Build params\n        $.each({city: 'city', county: 'county', state: 'state', country: 'country',\n                'postal_code': 'postalcode', 'country_code': 'countrycodes'}, function (key, value) {\n            if (json.address[key]) {\n                params[value] = json.address[key];\n            }\n        });\n\n        geocodeModule.nominatimSearch(params, query).success(function (json) {\n            console.log(JSON.stringify(json));\n            _insertCity(json[0]);\n        });\n\n    };\n\n\n\n    /**\n     * Use reverse geocode to define the name of the city at a given position\n     * @param {object} position - Longitude, latitude at EPSG:4326 projection\n     * @param {integer} zoom - Zoom level used for extraction\n     */\n    var _getCity = function (position, zoom) {\n\n        if (!position || !zoom) {\n            return false;\n        }\n\n        //console.log('Zoom: ' + zoom);\n        zoom = Math.min(Math.max((zoom || 10), 0), 18);\n        //console.log('Extraction level: ' + zoom);\n\n        var params = {\n            format: 'json',\n            lon: position[0],\n            lat: position[1],\n            zoom: zoom, //$('#zoom_level_extraction').val() || 10\n            osm_type: 'N',\n            addressdetails: 1,\n            extratags: 0,\n            namedetails: 0,\n            'accept-language': 'en'\n        };\n\n        geocodeModule.nominatimReverse(params).success(function (json) {\n            //console.log(JSON.stringify(json));\n\n            setTimeout(function () {\n                _getCityDetails(json);\n            }, 1000);\n            /*\n            if ($('#font_color_proportional, #font_size_proportional, #insert_local_name, #insert_icon').is(':checked')) {\n                // Wait 1s to respect the Nominatim policy\n                // and make a seconde request to get more details\n                setTimeout(function () {\n                    _getCityDetails(json);\n                }, 1000);\n            } else {\n                // Else insert the city name in editor\n                _insertCity(json);\n            }\n            */\n\n        });\n\n    };\n\n\n    /**\n     * Print editor content\n     * @param {Object} data - Formated text\n     */\n    var _print = function (data) {\n\n        console.log(data);\n\n        console.log($('#export_direction').val());\n        var $el = $('#export_direction');\n        if ($el && $el.val() === 'inline') {\n            data = data.replace(/<div>/g, ', ');\n            console.log(data);\n        }\n\n        var printWin = window.open('', window.location.hostname, ''); //height=600,width=800\n        printWin.document.write('<html>'\n                + '<head><title>' + window.location.hostname + '</title></head>'\n                + '<body>' + data + '</body></html>');\n        printWin.print();\n        printWin.close();\n\n        return true;\n    };\n\n\n\n    /**\n     * Start listening clicks on the map\n     * @public\n     * @param {Object} map - OL3 map\n     */\n    var setMap = function (map) {\n\n        map.on('click', function (evt) {\n\n            var view = map.getView();\n            var zoom = view.getZoom();\n            var position = evt.coordinate;\n            var projection = view.getProjection();\n\n            position = ol.proj.transform(position, projection.getCode(), 'EPSG:4326');\n            console.time('Reverse geocoding');\n            _getCity(position, zoom);\n            console.timeEnd('Reverse geocoding');\n\n        });\n\n    };\n\n\n\n    /**\n     * Toggle buttons visibility when editor is empty or not\n     */\n    var _toggleButtonStatusEmptyEditor = function () {\n\n        var $buttons = $('#copy_editor, #print_editor, #erase_editor');\n        if (editor.getLength() === 1) {\n            $buttons\n                .attr('disabled', true)\n                .closest('li').addClass('disabled');\n            //$('#get_started_alert').fadeIn();\n        } else {\n            $buttons\n                .attr('disabled', false)\n                .closest('li').removeClass('disabled');\n            //$('#get_started_alert').fadeOut();\n        }\n\n    };\n\n\n\n    $(document).ready(function () {\n\n        var $editor = $('#editor');\n\n        editor = new Quill('#editor', settings.quill);\n        editor.addModule('toolbar', {\n            container: '#editor_toolbar'\n        });\n        var qlMultiCursorModule = editor.addModule('multi-cursor', {\n            timeout: 10000\n        });\n\n        editor.on('selection-change', function (range) {\n\n            var $buttons = $('#editor_toolbar').find('.ql-bold, .ql-italic, .ql-strike, .ql-underline, .ql-size, .ql-color, .ql-background'); // .ql-font .ql-align .ql-bullet .ql-list .ql-image .ql-link\n            \n            if (range) {\n                if (range.start === range.end) {\n                    qlMultiCursorModule.setCursor('selectionStart', range.start, 'Insertion point', '#337ab7');\n                    $buttons.attr('disabled', true).closest('li').addClass('disabled');\n                    console.log('Cursor is on', range.start);\n                } else {\n                    //var text = editor.getText(range.start, range.end);\n                    $buttons.attr('disabled', false).closest('li').removeClass('disabled');\n                    //console.log('User has highlighted', text);\n                }\n            } else {\n                console.log('Cursor not in the editor');\n            }\n        });\n\n        editor.on('text-change', function (delta, source) {\n\n            // Copy editor content to hidden textarea (for garlic autosave)\n            $('#stored_roadbook').val(editor.getHTML()).trigger('change');\n\n            _toggleButtonStatusEmptyEditor();\n\n            // Auto-scroll the textarea to keep the last city visible\n            $editor.scrollTop($editor[0].scrollHeight);\n\n        });\n\n        // Populate editor with hidden textarea data\n        // once garlic has restored this field\n        // then move the cursor to the end\n        $('#stored_roadbook').garlic({\n            excluded: '',\n            onRetrieve: function (elem, retrievedValue) {\n                editor.setHTML(retrievedValue);\n                //var pos = editor.getLength() - 1;\n                //editor.setSelection(pos, pos);\n                //console.log('Cursor moved to position ' + pos);\n            }\n        });\n\n        _toggleButtonStatusEmptyEditor();\n\n        // Print button\n        $('#print_editor').click(function (e) {\n            e.preventDefault();\n            _print(editor.getHTML());\n        });\n\n        // Erase button\n        $('#erase_editor').click(function (e) {\n            e.preventDefault();\n\n            swal({\n                title: 'Are you sure?',\n                text: 'Your roadbook will be permanently deleted. You will not be able to recover it.',\n                type: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#DD6B55',\n                confirmButtonText: 'Yes delete it',\n                cancelButtonText: 'No stop !',\n                closeOnConfirm: false,\n                closeOnCancel: false\n            }, function (isConfirm) {\n                if (isConfirm) {\n                    editor.setText('');\n                    swal({\n                        title: 'Deleted!',\n                        text: 'Your roadbook has been deleted. Let\\'s start a new one!',\n                        type: 'success',\n                        timer: 2500,\n                        showConfirmButton: false\n                    });\n                } else {\n                    swal({\n                        title: 'Cancelled',\n                        text: 'Whew... you narrow escape! ^_^',\n                        type: 'error',\n                        timer: 2500,\n                        showConfirmButton: false\n                    });\n                }\n            });\n\n        });\n\n        // Copy to clipboard button\n        /*\n        var client = new ZeroClipboard(document.getElementById('copy_editor'));//editor\n        client.on('ready', function (readyEvent) {\n            console.log('ZeroClipboard ready');\n        });\n        client.on('copy', function (event) {\n            event.clipboardData.setData('text/plain', event.relatedTarget.innerHTML\n                //.replace(/[<&>'\"]/g, function (c) {\n                //    return \"&#\" + c.charCodeAt() + \";\";\n                //})\n            );\n            client.on('aftercopy', function (event) {\n                swal({title: 'Good job!', text: 'Your roadbook has been copied to the clipboard.', type: 'success', timer: 2500, showConfirmButton: true});\n            });\n        });\n        client.on('error', function (event) {\n            swal({title: 'Oups!', text: 'ZeroClipboard error of type \"' + event.name + '\": ' + event.message, type: 'warning', timer: 10000, showConfirmButton: true});\n            ZeroClipboard.destroy();\n        });\n        */\n\n        // Show / hide editor toolbar switch\n        /*var $el = $('#editor_toolbar_visibility');\n        $el.change(function () {\n            if ($el.is(':checked')) {\n                $('#editor_toolbar').show();\n            } else {\n                $('#editor_toolbar').hide();\n            }\n        });//.trigger('change');*/\n\n    });\n\n    return {\n        setMap: setMap\n        //getCityDetails: getCityDetails,\n        //insertCity: insertCity\n    };\n\n})();"]}