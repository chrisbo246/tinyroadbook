{"version":3,"sources":["../../app/scripts/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["//jslint browser: true\n//global window, $, ol, swal, mapModule, mapLayersModule, mapControlsModule, tabModule, adsenseModule, cityPickerModule\n/**\n * @fileOverview TinyRoadbook application\n * @author Christophe Boisier\n * @version: 0.1\n */\n\n/**\n * Main module.\n * @external jQuery\n * @external OL3\n * @external swal\n * @external mapModule\n * @external mapLayersModule\n * @external mapControlsModule\n * @external tabModule\n * @external adsenseModule\n * @external cityPickerModule\n * @module\n * @returns {Object} Public functions and variables\n */\nvar appModule = (function () {\n    'use strict';\n\n    var map1;\n\n    // Base layers\n    var mapquestSatLayer = mapLayersModule.create('mapquestSat');\n    var openCycleMapLayer = mapLayersModule.create('openCycleMap');\n    var openStreetMapLayer = mapLayersModule.create('openStreetMap', {visible: true});\n    var openStreetMapHumanitarianLayer = mapLayersModule.create('openStreetMapHumanitarian');\n    var thunderforestTransportLayer = mapLayersModule.create('thunderforestTransport');\n    var thunderforestOutdoorLayer = mapLayersModule.create('thunderforestOutdoor');\n\n    // Overlays\n    var mapquestHybLayer = mapLayersModule.create('mapquestHyb');\n    var lonviaHikingLayer = mapLayersModule.create('lonviaHiking');\n    var lonviaCyclingLayer = mapLayersModule.create('lonviaCycling');\n    var gpxLayer = new ol.layer.Vector({\n        name: 'gpsTrack',\n        visible: false,\n        source: new ol.source.Vector({\n            format: new ol.format.GPX()\n        }),\n        style: new ol.style.Style({\n            stroke: new ol.style.Stroke({\n                color: 'rgba(0, 255, 0, 0.7)',\n                width: 3\n            })\n        })\n    });\n\n    // Controls\n    var attributionControl = mapControlsModule.create('attribution');\n    var scaleLineControl = mapControlsModule.create('scaleLine');\n    var fullScreenControl = mapControlsModule.create('fullScreen');\n    var layerSwitcherControl = mapControlsModule.create('layerSwitcher');\n\n\n\n    /**\n     * Initialize an OL3 map\n     * @param {target} target - Map div selector\n     * @return {object} - The map object\n     */\n    var _addMap = function (target) {\n\n        var layers = [\n            new ol.layer.Group({\n                name: 'baseLayers',\n                title: 'Base map',\n                layers: [\n                    mapquestSatLayer,\n                    openStreetMapHumanitarianLayer,\n                    thunderforestTransportLayer,\n                    thunderforestOutdoorLayer,\n                    openCycleMapLayer,\n                    openStreetMapLayer\n                ]\n            }),\n            new ol.layer.Group({\n                name: 'overlays',\n                title: 'Overlays',\n                layers: [\n                    gpxLayer,\n                    mapquestHybLayer,\n                    lonviaHikingLayer,\n                    lonviaCyclingLayer\n                ]\n            })\n        ];\n\n        var controls = ol.control.defaults({\n            attribution: false,\n            attributionOptions: /** @type {olx.control.AttributionOptions} */ ({\n                collapsible: false\n            }),\n            zoomOptions: {\n                // zoomInTipLabel: $.t('buttons:olZoomIn.label'),\n                // zoomOutTipLabel: $.t('buttons:olZoomOut.label')\n            }\n        }).extend([\n            attributionControl,\n            scaleLineControl,\n            fullScreenControl,\n            layerSwitcherControl\n        ]);\n\n        return new ol.Map({\n            layers: layers,\n            target: target,\n            view: new ol.View({\n                center: [0, 0],\n                zoom: 4\n            }),\n            controls: controls\n        });\n\n    };\n\n\n\n    $(document).ready(function () {\n\n        // Initialize the map when pane become visible for the first time\n        $('a[data-toggle=\"tab\"]').one('shown.bs.tab', function (e) {\n            var paneId = $(e.target).attr('href');\n            if (paneId === '#picker') {\n                map1 = _addMap('map');\n                mapModule.centerOnPosition(map1);\n                cityPickerModule.setMap(map1);\n                $('#gpx_file_path').on('change', function () {\n                    layerSwitcherControl.renderPanel();\n                });\n            }\n        });\n\n        if (window.File && window.FileReader && window.FileList && window.Blob) {\n            mapModule.setFileSource('#gpx_file_path', gpxLayer);\n        } else {\n            $('#gpx_file_path').closest('.form-group').hide();\n        }\n\n        $('.start-editing').click(function () {\n            $('a[href=\"#picker\"]').tab('show');\n        });\n\n        // excluded: 'input[type=\"file\"], input[type=\"hidden\"], input[type=\"submit\"], [data-persist=\"false\"]'\n        $('input[type=\"hidden\"]').trigger('change');\n        // Garlic reset buttons\n        $('#reset_settings').click(function () {\n            $('#settings form').garlic('destroy');\n            location.reload();\n        });\n\n        /*window.update_cookieconsent_options({\n            //learnMore: 'Learn more'\n            theme: 'light-floating'\n        });*/\n       \n        commonsModule.adsense();\n        commonsModule.parallax();\n        commonsModule.adsense();\n        commonsModule.storeActiveTab();\n        commonsModule.resetButton();\n        commonsModule.loadGoogleFonts();\n        \n    });\n\n    return {\n        map: map1\n    };\n\n})();"]}