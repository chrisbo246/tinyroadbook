{"version":3,"sources":["../../app/scripts/main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["//jslint browser: true\n//global window, $, ol, swal, mapModule, mapLayersModule, mapControlsModule, tabModule, adsenseModule, cityPickerModule\n/**\n * @fileOverview TinyRoadbook application\n * @author Christophe Boisier\n * @version: 0.1\n */\n\n/**\n * Main module.\n * @external jQuery\n * @external OL3\n * @external swal\n * @external mapModule\n * @external mapLayersModule\n * @external mapControlsModule\n * @external tabModule\n * @external adsenseModule\n * @external cityPickerModule\n * @module\n * @returns {Object} Public functions and variables\n */\nvar appModule = (function () {\n    'use strict';\n\n    var settings = {\n        adsense: {\n            adClient: 'ca-pub-8495719252049968'\n        }\n    };\n\n    var map1;\n\n    // Base layers\n    var mapquestSatLayer = mapLayersModule.create('mapquestSat');\n    var openCycleMapLayer = mapLayersModule.create('openCycleMap');\n    var openStreetMapLayer = mapLayersModule.create('openStreetMap', {visible: true});\n    var openStreetMapHumanitarianLayer = mapLayersModule.create('openStreetMapHumanitarian');\n    var thunderforestTransportLayer = mapLayersModule.create('thunderforestTransport');\n    var thunderforestOutdoorLayer = mapLayersModule.create('thunderforestOutdoor');\n\n    // Overlays\n    var mapquestHybLayer = mapLayersModule.create('mapquestHyb');\n    var lonviaHikingLayer = mapLayersModule.create('lonviaHiking');\n    var lonviaCyclingLayer = mapLayersModule.create('lonviaCycling');\n    var gpxLayer = new ol.layer.Vector({\n        name: 'gpsTrack',\n        visible: false,\n        source: new ol.source.Vector({\n            format: new ol.format.GPX()\n        }),\n        style: new ol.style.Style({\n            stroke: new ol.style.Stroke({\n                color: 'rgba(0, 255, 0, 0.7)',\n                width: 3\n            })\n        })\n    });\n\n    // Controls\n    var attributionControl = mapControlsModule.create('attribution');\n    var scaleLineControl = mapControlsModule.create('scaleLine');\n    var fullScreenControl = mapControlsModule.create('fullScreen');\n    var layerSwitcherControl = mapControlsModule.create('layerSwitcher');\n\n\n\n    /**\n     * Initialize an OL3 map\n     * @param {target} target - Map div selector\n     * @return {object} - The map object\n     */\n    var _addMap = function (target) {\n\n        var layers = [\n            new ol.layer.Group({\n                name: 'baseLayers',\n                title: 'Base map',\n                layers: [\n                    mapquestSatLayer,\n                    openStreetMapHumanitarianLayer,\n                    thunderforestTransportLayer,\n                    thunderforestOutdoorLayer,\n                    openCycleMapLayer,\n                    openStreetMapLayer\n                ]\n            }),\n            new ol.layer.Group({\n                name: 'overlays',\n                title: 'Overlays',\n                layers: [\n                    gpxLayer,\n                    mapquestHybLayer,\n                    lonviaHikingLayer,\n                    lonviaCyclingLayer\n                ]\n            })\n        ];\n\n        var controls = ol.control.defaults({\n            attribution: false,\n            attributionOptions: /** @type {olx.control.AttributionOptions} */ ({\n                collapsible: false\n            }),\n            zoomOptions: {\n                // zoomInTipLabel: $.t('buttons:olZoomIn.label'),\n                // zoomOutTipLabel: $.t('buttons:olZoomOut.label')\n            }\n        }).extend([\n            attributionControl,\n            scaleLineControl,\n            fullScreenControl,\n            layerSwitcherControl\n        ]);\n\n        return new ol.Map({\n            layers: layers,\n            target: target,\n            view: new ol.View({\n                center: [0, 0],\n                zoom: 4\n            }),\n            controls: controls\n        });\n\n    };\n\n\n\n    $(document).ready(function () {\n\n        adsenseModule.init(settings.adsense);\n\n        // Initialize the map when pane become visible for the first time\n        $('a[data-toggle=\"tab\"]').one('shown.bs.tab', function (e) {\n            var paneId = $(e.target).attr('href');\n            if (paneId === '#picker') {\n                map1 = _addMap('map');\n                mapModule.centerOnPosition(map1);\n                cityPickerModule.setMap(map1);\n                $('#gpx_file_path').on('change', function () {\n                    layerSwitcherControl.renderPanel();\n                });\n            }\n        });\n\n        if (window.File && window.FileReader && window.FileList && window.Blob) {\n            mapModule.setFileSource('#gpx_file_path', gpxLayer);\n        } else {\n            $('#gpx_file_path').closest('.form-group').hide();\n        }\n\n        $('.start-editing').click(function () {\n            $('a[href=\"#picker\"]').tab('show');\n        });\n\n        // excluded: 'input[type=\"file\"], input[type=\"hidden\"], input[type=\"submit\"], [data-persist=\"false\"]'\n        $('input[type=\"hidden\"]').trigger('change');\n        // Garlic reset buttons\n        $('#reset_settings').click(function () {\n            $('#settings form').garlic('destroy');\n            location.reload();\n        });\n        $('#reset_all').click(function () {\n            swal({\n                title: 'Are you sure?',\n                text: 'This will reset settings, erase your roadbook and delete local data stored by this application.',\n                type: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#DD6B55',\n                confirmButtonText: 'Yes reset all',\n                cancelButtonText: 'No stop !',\n                closeOnConfirm: false,\n                closeOnCancel: false\n            }, function (isConfirm) {\n                if (isConfirm) {\n                    var cookies = document.cookie.split(';');\n                    cookies.forEach(function (cookie) {\n                        document.cookie = cookie.split('=')[0]\n                                + '=; username=; expires=Thu, 01 Jan 1970 00:00:00 UTC';\n                    });\n                    localStorage.clear();\n                    location.reload();\n                    //navigator.geolocation.clearWatch();\n                } else {\n                    swal('Cancelled', 'You can continue where you left off.', 'error');\n                }\n            });\n        });\n\n        // Automatically reload the last opened tab\n        tabModule.rememberTab('#main-nav', !localStorage);\n\n        /*window.update_cookieconsent_options({\n            //learnMore: 'Learn more'\n            theme: 'light-floating'\n        });*/\n\n    });\n\n    return {\n        map: map1\n    };\n\n})();"]}